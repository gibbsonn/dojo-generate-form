<html>
<head>
    <!-- required: a default dijit theme: -->
    <link id="themeStyles" rel="stylesheet" href="../../dijit/themes/claro/claro.css"/>

    <style type="text/css">
        /*		@import "../../../dijit/tests/css/dijitTests.css";*/
        /* a sample set of definitions to use as a foundation to color your code */
        @import "../../dojox/highlight/resources/highlight.css";

        /* additional styling for this test case */
        pre.examplecode code[class]:after {
            content: 'highlight: ' attr(class);
            display: block;
            text-align: right;
            font-size: smaller;
            color: #CCC;
            background: white;
            border-top: solid 1px;
            padding-top: 0.5em;
        }

        pre code {
            display: block;
        }

        code {
            background: #F0F0F0;
        }

        pre code,
        .ruby .subst {
            color: black;
        }
    </style>


    <!-- required: dojo.js -->
    <script type="text/javascript" src="../../dojo/dojo.js"
            data-dojo-config="async:true,parseOnLoad: false, isDebug: true"></script>


    <script type="text/javascript">

        require([ '../schema/transform',
            './schema/Schema',
            '../util/Resolver',
            'dojo/when',
            'dojo/promise/all',
            "dojo/parser",
            "dojo/text!gform/doc/schema/groups.json", "dojo/text!gform/schema/attributes.json",
            "gform/createStandardEditorFactory", "gform/util/refresolve", "dojo/text!./schema.tpl", "gform/doc/Template", "gform/doc/TemplateContext", "dojox/highlight"
        ], function (transform, Schema, Resolver, when, all, parser, groups, attributes, createStandardEditorFactory, refresolve, schemaTemplate, Template, TemplateContext, highlight) {

            var ef = createStandardEditorFactory();
            var groupSchemas = JSON.parse(groups);
            var attributeSchemas = JSON.parse(attributes);
            var resolver = new Resolver({baseUrl: "../schema/", transformations: transform});
            when(resolver.resolve(attributeSchemas)).then(function () {
                //var meta = convertSchema(schema);
                var schema = new Schema;
                var as = schema.prepare(attributeSchemas);

                var template = new Template(schemaTemplate);
                var ctx = {attributes: as, groups: groupSchemas, ctx: new TemplateContext()};
                var html = template.render(ctx);
                dojo.byId("inline").innerHTML = html;
                parser.parse();
                dojo.query("pre > code").forEach(highlight.init);
            });
        });


    </script>
</head>
<body class="claro">
<div id="inline">
</div>
</body>
</html>
